<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analytics - Mir Dujanah Ali Hussaini</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-9J7MJXMGGW"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-9J7MJXMGGW');
    </script>
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="index.html">
                    <svg class="nav-logo-img" width="40" height="40" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">
                        <circle cx="50" cy="50" r="45" fill="#2563eb" opacity="0.9"/>
                        <text x="50" y="65" text-anchor="middle" fill="white" font-size="40" font-family="Inter, sans-serif" font-weight="bold">MD</text>
                    </svg>
                    <span class="nav-logo-text">Mir Dujanah</span>
                </a>
            </div>
            <ul class="nav-menu">
                <li class="nav-item"><a href="index.html" class="nav-link">Home</a></li>
                <li class="nav-item"><a href="blog.html" class="nav-link">Blog</a></li>
                <li class="nav-item"><a href="analytics.html" class="nav-link">Analytics</a></li>
            </ul>
        </div>
    </nav>

    <section class="analytics-hero">
        <div class="container">
            <h1>Website Analytics</h1>
            <p>Track visitor statistics and engagement</p>
        </div>
    </section>

    <section class="analytics-stats">
        <div class="container">
            <div class="analytics-controls">
                <button id="exportData" class="btn btn-primary">Export Data</button>
                <button id="refreshData" class="btn btn-secondary">Refresh</button>
            </div>
            
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-eye"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="visitCount">Loading...</h3>
                        <p>Total Visits</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-file-pdf"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="resumeDownloads">Loading...</h3>
                        <p>Resume Downloads</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-folder-open"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="portfolioDownloads">Loading...</h3>
                        <p>Portfolio Downloads</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-envelope"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="contactSubmissions">Loading...</h3>
                        <p>Contact Submissions</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-clock"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="avgTimeOnSite">Loading...</h3>
                        <p>Avg. Time on Site</p>
                    </div>
                </div>
                
                <div class="stat-card">
                    <div class="stat-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <div class="stat-content">
                        <h3 id="conversionRate">Loading...</h3>
                        <p>Conversion Rate</p>
                    </div>
                </div>
            </div>
            
            <div class="analytics-details">
                <div class="detail-section">
                    <h3>Top Projects</h3>
                    <div id="topProjects" class="detail-list">Loading...</div>
                </div>
                
                <div class="detail-section">
                    <h3>Device Breakdown</h3>
                    <div id="deviceBreakdown" class="detail-list">Loading...</div>
                </div>
                
                <div class="detail-section">
                    <h3>Top Referrers</h3>
                    <div id="topReferrers" class="detail-list">Loading...</div>
                </div>
                
                <div class="detail-section">
                    <h3>Download Statistics</h3>
                    <div class="download-stats">
                        <div class="stat-item">
                            <span>Resume Downloads:</span>
                            <span id="resumeDownloadCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span>Portfolio Downloads:</span>
                            <span id="portfolioDownloadCount">0</span>
                        </div>
                        <div class="stat-item">
                            <span>Top Download Source:</span>
                            <span id="topDownloadSource">Hero Section</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script src="analytics-dashboard.js"></script>
    <script src="download-tracker.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            updateAnalyticsDisplay();
            
            document.getElementById('exportData').addEventListener('click', () => {
                window.portfolioAnalytics.exportData();
            });
            
            document.getElementById('refreshData').addEventListener('click', () => {
                updateAnalyticsDisplay();
            });
        });
        
        function updateAnalyticsDisplay() {
            const report = window.portfolioAnalytics.generateReport();
            
            document.getElementById('visitCount').textContent = report.totalVisits;
            document.getElementById('resumeDownloads').textContent = report.resumeDownloads;
            document.getElementById('portfolioDownloads').textContent = report.portfolioDownloads;
            document.getElementById('contactSubmissions').textContent = report.contactSubmissions;
            document.getElementById('avgTimeOnSite').textContent = formatTime(report.avgTimeOnSite);
            document.getElementById('conversionRate').textContent = report.conversionRate + '%';
            
            updateTopProjects(report.topProjects);
            updateDeviceBreakdown(report.deviceBreakdown);
            updateTopReferrers(report.topReferrers);
            updateDownloadStats();
        }
        
        function updateDownloadStats() {
            if (window.downloadTracker) {
                const downloadReport = window.downloadTracker.generateReport();
                document.getElementById('resumeDownloadCount').textContent = downloadReport.resume.total;
                document.getElementById('portfolioDownloadCount').textContent = downloadReport.portfolio.total;
                document.getElementById('topDownloadSource').textContent = downloadReport.resume.topSource || 'Hero Section';
            }
        }
        
        function formatTime(seconds) {
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return `${mins}:${secs.toString().padStart(2, '0')}`;
        }
        
        function updateTopProjects(projects) {
            const container = document.getElementById('topProjects');
            if (projects.length === 0) {
                container.innerHTML = `
                    <div class="detail-item">
                        <span>Sanitizable Access Control System</span>
                        <span class="detail-value">Featured Project</span>
                    </div>
                    <div class="detail-item">
                        <span>Handwritten Digits Classification</span>
                        <span class="detail-value">AI/ML Project</span>
                    </div>
                    <div class="detail-item">
                        <span>News Classification Using NLP</span>
                        <span class="detail-value">NLP Project</span>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = projects.map(([name, views]) => 
                `<div class="detail-item">
                    <span>${name}</span>
                    <span class="detail-value">${views} views</span>
                </div>`
            ).join('');
        }
        
        function updateDeviceBreakdown(devices) {
            const container = document.getElementById('deviceBreakdown');
            const entries = Object.entries(devices);
            
            if (entries.length === 0) {
                container.innerHTML = `
                    <div class="detail-item">
                        <span>Desktop</span>
                        <span class="detail-value">Primary</span>
                    </div>
                    <div class="detail-item">
                        <span>Mobile</span>
                        <span class="detail-value">Growing</span>
                    </div>
                    <div class="detail-item">
                        <span>Tablet</span>
                        <span class="detail-value">Supported</span>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = entries.map(([device, count]) => 
                `<div class="detail-item">
                    <span>${device.charAt(0).toUpperCase() + device.slice(1)}</span>
                    <span class="detail-value">${count} visits</span>
                </div>`
            ).join('');
        }
        
        function updateTopReferrers(referrers) {
            const container = document.getElementById('topReferrers');
            
            if (referrers.length === 0) {
                container.innerHTML = `
                    <div class="detail-item">
                        <span>GitHub</span>
                        <span class="detail-value">Repository</span>
                    </div>
                    <div class="detail-item">
                        <span>LinkedIn</span>
                        <span class="detail-value">Professional</span>
                    </div>
                    <div class="detail-item">
                        <span>Direct</span>
                        <span class="detail-value">Bookmark</span>
                    </div>
                `;
                return;
            }
            
            container.innerHTML = referrers.map(([referrer, count]) => 
                `<div class="detail-item">
                    <span>${referrer}</span>
                    <span class="detail-value">${count} visits</span>
                </div>`
            ).join('');
        }
    </script>
</body>
</html>